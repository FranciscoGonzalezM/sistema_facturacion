{% extends "core/base.html" %}
{% load static %}
{% load org_tags %}

{% block title %}Panel de Administraci√≥n{% endblock %}

{% block content %}
<style>
.top-buttons { display:flex; gap:12px; margin-bottom:25px; }
.top-buttons a { padding:10px 18px; border-radius:10px; background:#4a5568; color:white; text-decoration:none; font-size:15px; font-weight:500; transition:.2s;}
.top-buttons a:hover { background:#2d3748; }
.card-custom { border-radius:15px; padding:20px; background:linear-gradient(135deg,#e8edf3,#d8dee6); box-shadow:0 3px 8px rgba(0,0,0,0.15); text-align:center; transition:.3s;}
.card-custom:hover { transform:translateY(-4px);}
.card-number { font-size:42px; font-weight:bold; color:#1a202c; }
.card-title { font-size:18px; margin-top:5px; color:#4a5568; font-weight:600; }
</style>

<div class="container mt-4">
    {% comment %}Header: single logo+name block below (we removed duplicated right-side logo).{% endcomment %}
    <div class="d-flex justify-content-between align-items-center mb-4">
        <div class="d-flex align-items-center">
            {% if request.organizacion.logo %}
                <img src="{{ request.organizacion.logo.url }}" alt="Logo" class="img-fluid me-2" style="max-height:48px; border-radius:6px;"/>
            {% endif %}
            <div><strong>{{ request.organizacion.nombre }}</strong></div>
        </div>
        <div class="d-flex align-items-center">
            <a class="btn btn-primary me-3" href="{% url 'organizaciones:editar' %}">Editar empresa</a>
        </div>
    </div>

    {# Quick action buttons: hide for tenant members (they have the sidebar). Show only to staff/global users. #}
    {% if request.user.is_staff or not request.organizacion %}
    <div class="top-buttons">
        {% is_org_role 'owner,admin' as is_org_admin %}
        {% is_org_role 'cajero' as is_cajero %}
        {% comment %}Show management links only to staff or owner/admin (but hide for cajero).{% endcomment %}
        {% if request.user.is_staff or is_org_admin and not is_cajero %}
            <a href="{% url 'clientes:cliente_list' %}">Clientes</a>
            <a href="{% url 'productos:producto_list' %}">Productos</a>
            <a href="{% url 'requiza:requiza_list' %}">Requisas</a>
        {% endif %}
        <a href="{% url 'facturas:factura_list' %}">Facturas</a>
        <a href="{% url 'facturas:facturar' %}">Facturar</a>
    </div>
    {% endif %}

    <div class="row g-3">
        <div class="col-md-3">
            <div class="card-custom">
                <div class="card-title">Clientes</div>
                <div class="card-number">{{ total_clientes|default_if_none:"0" }}</div>
            </div>
        </div>
        <div class="col-md-3">
            <div class="card-custom">
                <div class="card-title">Productos</div>
                <div class="card-number">{{ total_productos|default_if_none:"0" }}</div>
            </div>
        </div>
        <div class="col-md-3">
            <div class="card-custom">
                <div class="card-title">Facturas</div>
                <div class="card-number">{{ total_facturas|default_if_none:"0" }}</div>
            </div>
        </div>
        <div class="col-md-3">
            <div class="card-custom">
                <div class="card-title">Requisas</div>
                <div class="card-number">{{ total_requizas|stringformat:"s"|default:"0" }}</div>
            </div>
        </div>
    </div>
</div>

{% endblock %}







